% Three state model: I<->I->A->E. In I, there is a probability% p that I->A->E (an egg is released). But there is also a probability% q=1-p that I is recylced back to I. The time constant for A->E is % lambda1, the time constant of I->I is lambda2. %% INPUT:  N: total number of eggs laid% 	  p: probability that I->A (default=0.6)%   lambda1: time constant for A->E (default=0.1)%   lambda2: time constant for I->I (default=0.005)% OUTPUT: X: intervals between eggs laid, Nx1%% Usage: X=iae(N,p,lambda1,lamda2)% SEE ALSO: randexp.m% 					G. Tong Zhou% 					Feb. 9, 1997function X=iae(N,p,lambda1,lambda2)if nargin<4   lambda2=0.005;			% default time constant I->I end if nargin<3   lambda1=0.1;				% default time constant A->Eendif nargin<2   p=0.6;				% default probability I->Aendq=1-p;					% probability that I->IX=[];					% stores inter-arrival timeslag=0;					% time takes A->I->A->I... before En=0;while n<N  a=rand;				% uniform r.v.   if a<p				% w/ prob. p, I->A     x0=randexp(1,1,lambda1);		% time takes A->E     x=x0+lag;				% time takes I->I->I->I...->A->E     X=[X; x];				% stores inter-arrival times     lag=0;				% resets lag     n=n+1;  else      I2A=randexp(1,1,lambda2);     lag=lag+I2A;			% recycle once more  endend 