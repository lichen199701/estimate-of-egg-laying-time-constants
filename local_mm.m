% Given y(x), find the local maxima and minima of y.% % INPUT:  x: horizontal axis%  	  y: vertical axis% OUTPUT: max_y: local maxima y values %         max_loc: location of local maxima%         min_y: local minima y values %         min_loc: location of local manima%% Usage: [max_y,max_loc,min_y,min_loc]=local_mm(x,y)% SEE ALSO: shift.m% 					G. Tong Zhou% 					Mar. 1, 1997function [max_y,max_loc,min_y,min_loc]=local_mm(x,y)x=x(:); 				% make x a column vectory=y(:);					% make y a column vectordy1=y-shift(y,-1);			% dy1[n]=y[n]-y[n-1]dy1(1)=dy1(2); 				% free of initial shift effectdy1=dy1>0;				% dy1=1 if y is increasing					% dy1=0 if y is decreasingdy2=dy1-shift(dy1,-1);			% dy2[n]=dy1[n]-dy1[n-1]dy2(1)=dy2(2);				% free of initial shift effectdy2=-dy2;				% dy2=1 if local maximum					% dy2=-1 if local minimumindex=find(dy2==1)-1;			% local maximamax_y=y(index); 			% local maxima valuesmax_loc=x(index);			% local maxima locationsindex=find(dy2==-1)-1;			% local minimamin_y=y(index); 			% local minima valuesmin_loc=x(index);			% local minima locations