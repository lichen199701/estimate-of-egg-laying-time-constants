% Given the observed intervals, estimate model parameters% using the maximum likelihood method. Provide standard% deviation of these estimates from Monte Carlo runs.%% INPUT:   x: intervals%      MONTE: # independent runs for std calculation; default=200% OUTPUT:  p: probability of A->E%     lambda1: time constant for the I->I cycle%     lambda2: time constant for the A->A cycle%       std_p: standard deviation of the p estimate; optional% std_lambda1: standard deviation of the lambda1 estimate; optional% std_lambda2: standard deviation of the lambda2 estimate; optional%% Usage: [p,lambda1,lambda2,std_p,std_lambda1,std_lambda2]=ml_complete(x,[MONTE]) % SEE ALSO: ml_est.m, iae.m%% Example: [p,lambda1,lambda2]=ml_complete(x);  % estimate parameters only % Example: [p,lambda1,lambda2,std_p,std_lambda1,std_lambda2]=ml_complete(x,300) %		% estimate parameters and calculate stds from 300 runs% Example: [p,lambda1,lambda2,std_p,std_lambda1,std_lambda2]=ml_complete(x) %		% estimate parameters and calculate stds from 200 runs % 					G. Tong Zhou% 					Oct. 1, 1997function [p,lambda1,lambda2,std_p,std_lambda1,std_lambda2]=ml_complete(x,MONTE) % *********************** ML Estimates ****************************[p,lambda1,lambda2]=ml_est_only(x);		% ML parameter estimates if nargout==3				% no need to calculate std   returnend% ********************** STD Calculation **************************if nargin==1   MONTE=200;				% defaultendN=length(x);				% data lengthEST=[];					% store estimates over runsfor monte=1:MONTE  x0=iae(N,p,lambda1,lambda2);         	% simulated intervals  [p0,lambda10,lambda20]=ml_est_only(x0);	% parameter estimates  EST=[EST; [p0,lambda10,lambda20]];	% stack estimatesendstd_est=std(EST);std_p=std_est(1);			% std of the p estimatestd_lambda1=std_est(2);			% std of the lambda1 estimatestd_lambda2=std_est(3);			% std of the lambda2 estimate%%   display results%pl=[p;std_p];l1l=[lambda1;std_lambda1];l2l=[lambda2;std_lambda2];disp([' '])disp(['ML estimate of 3-State Model Parameters']);MaxLikelihoodEstimate = table(categorical({'ML estimate';'     std_dev'}),...    pl,l1l,l2l,'VariableNames',{'quantity','p','lambda1','lambda2'})