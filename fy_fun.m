% We know the true fY(y) of the log intervals y=log(x). % We can fit fY(y) to the histogram of the observed y's% to estimate the model parameters. Service program for% fmins.%% INPUT:  para: length 3 vector containing [p,lambda1,lambda2]%           y:  bins of log intervals%          fy:  bin counts that correspond to bins in y%% Usage:  para=fmins('fy_fun',para0,options,[],y,fy);%% Note: z is squared error between the theoretical fy(y) and the %       actual bin counts; objective function%       para0 contains initial estimates of the parameters%                                       G. Tong Zhou%                                       May 20, 1997function z=fy_fun(para,y,fy)p=para(1);lambda1=para(2);lambda2=para(3);k1=p*(lambda1-lambda2)/(lambda1-p*lambda2);     % weightk2=lambda1*(1-p)/(lambda1-p*lambda2);           % weightfyy=(k1*lambda1*exp(-lambda1*exp(y))...    +k2*p*lambda2*exp(-p*lambda2*exp(y))).*exp(y);      % theoretical fY(y)z=sum((fy-fyy).^2);                             % squared errory0=[0:0.1:10];fy0=(k1*lambda1*exp(-lambda1*exp(y0))...    +k2*p*lambda2*exp(-p*lambda2*exp(y0))).*exp(y0);%bar(y,fy)							commented out-WRS 5/6/99%title('Histogram of the log intervals')%hold on%plot(y0,fy0,':')%hold off%pause(0.05)